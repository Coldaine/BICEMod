
mst_reformat_variables = {
	set_variable = { global.mst_display_variable_C1 = global.mst_variable_C1 }
	set_variable = { global.mst_display_variable_C2 = global.mst_variable_C2 }
	set_variable = { global.mst_display_variable_S1 = global.mst_variable_S1 }
	set_variable = { global.mst_display_variable_S2 = global.mst_variable_S2 }
	divide_variable = { global.mst_display_variable_C1 = 1000 }
	divide_variable = { global.mst_display_variable_C2 = 1000 }
	divide_variable = { global.mst_display_variable_S1 = 1000 }
	divide_variable = { global.mst_display_variable_S2 = 1000 }
}

smt_upgrade_state_category = {
	IF = {
		limit = {
			OR = {
				has_state_category = wasteland
				has_state_category = enclave
			}
		}
		set_state_category = pastoral
	}
	ELSE_IF = {
		limit = { has_state_category = tiny_island }
		set_state_category = small_island
	}
	ELSE_IF = {
		limit = {
			has_state_category = pastoral
		}
		set_state_category = rural
	}
	ELSE_IF = {
		limit = {
			has_state_category = small_island
		}
		set_state_category = rural
		set_state_flag = bst_was_island
	}
	ELSE_IF = {
		limit = {
			OR = {
				has_state_category = rural
				#has_state_category = developed_rural #road to 56 specific
			}
		}
		set_state_category = town
	}
	ELSE_IF = {
		limit = { has_state_category = town }
		set_state_category = large_town
	}
	ELSE_IF = {
		limit = { has_state_category = large_town }
		set_state_category = city
	}
	ELSE_IF = {
		limit = { has_state_category = city }
		set_state_category = large_city
	}
	ELSE_IF = {
		limit = { has_state_category = large_city }
		set_state_category = metropolis
	}
	ELSE_IF = {
		limit = { has_state_category = metropolis }
		set_state_category = megalopolis
	}
}

smt_downgrade_state_category = {
	IF = {
		limit = { has_state_category = megalopolis }
		set_state_category = metropolis
	}	
	ELSE_IF = {
		limit = { has_state_category = metropolis }
		set_state_category = large_city
	}
	ELSE_IF = {
		limit = { has_state_category = large_city }
		set_state_category = city
	}
	ELSE_IF = {
		limit = { has_state_category = city }
		set_state_category = large_town
	}
	ELSE_IF = {
		limit = { has_state_category = large_town }
		set_state_category = town
	}
	ELSE_IF = {
		limit = { has_state_category = town }
		set_state_category = rural
	}
	ELSE_IF = {
		limit = {
			has_state_category = rural
			has_state_flag = bst_was_island
		}
		set_state_category = small_island
	}
	ELSE_IF = {
		limit = {
			has_state_category = rural
		}
		set_state_category = pastoral
	}
	ELSE_IF = {
		limit = {
			has_state_category = pastoral
		}
		set_state_category = wasteland
	}
	ELSE_IF = {
		limit = {
			has_state_category = small_island
		}
		set_state_category = tiny_island
	}
}

bst_count_buildings = {
	bst_count_navf = yes
	bst_count_armsf = yes
	bst_count_civf = yes
	bst_count_inf = yes
	bst_count_airb = yes
	bst_count_aa = yes
	bst_count_radar = yes
	bst_count_rocket = yes
	bst_count_nuclear = yes
	bst_count_synthetic = yes
	bst_count_silo = yes
}

bst_count_inf = {
	
	every_country = {
		set_variable = {
			This.bst_country_average_inf = 0
		}
		set_variable = {
			This.bst_country_num_states = This.num_owned_states
		}
	}	
	every_state = {
		set_variable = {
			bst_state_inf = 0
		}
		add_to_variable = { bst_state_inf = This.infrastructure_level }
		OWNER = {
			add_to_variable = { This.bst_country_average_inf = Prev.bst_state_inf }
		}
	}
	every_country = {
		divide_variable = { This.bst_country_average_inf = This.bst_country_num_states }
	}	
}


bst_count_airb = {
	
	every_country = {
		set_variable = {
			This.bst_country_average_airb = 0
		}
		set_variable = {
			This.bst_country_num_states = This.num_owned_states
		}
	}	
	every_state = {
		set_variable = {
			This.airb_level = 0
		}
		if = {
			limit = {
				air_base < 1
			}
			add_to_variable = { This.airb_level = 0 }
		}
		if = {
			limit = {
				air_base > 0
				air_base < 2
			}
			add_to_variable = { This.airb_level = 1 }
		}
		if = {
			limit = {
				air_base > 1
				air_base < 3
			}
			add_to_variable = { This.airb_level = 2 }
		}
		if = {
			limit = {
				air_base > 2
				air_base < 4
			}
			add_to_variable = { This.airb_level = 3 }
		}
		if = {
			limit = {
				air_base > 3
				air_base < 5
			}
			
			add_to_variable = { This.airb_level = 4 }
		}
		if = {
			limit = {
				air_base > 4
				air_base < 6
			}
			add_to_variable = { This.airb_level = 5 }
		}
		if = {
			limit = {
				air_base > 5
				air_base < 7
			}
			add_to_variable = { This.airb_level = 6 }
		}
		if = {
			limit = {
				air_base > 6
				air_base < 8
			}
			add_to_variable = { This.airb_level = 7 }
		}
		if = {
			limit = {
				air_base > 7
				air_base < 9
			}
			add_to_variable = { This.airb_level = 8 }
		} 
		if = {
			limit = {
				air_base > 8
				air_base < 10
			}
			add_to_variable = { This.airb_level = 9 }
		}
		if = {
			limit = {
				air_base > 9
				air_base < 11
			}
			add_to_variable = { This.airb_level = 10 }
		}
		if = {
			limit = {
				air_base > 10
				air_base < 12
			}
			add_to_variable = { This.airb_level = 11 }
		}
		if = {
			limit = {
				air_base > 11
				air_base < 13
			}
			add_to_variable = { This.airb_level = 12 }
		}
		if = {
			limit = {
				air_base > 12
				air_base < 14
			}
			add_to_variable = { This.airb_level = 13 }
		}
		if = {
			limit = {
				air_base > 13
				air_base < 15
			}
			add_to_variable = { This.airb_level = 14 }
		}
		if = {
			limit = {
				air_base > 14
				air_base < 16
			}
			add_to_variable = { This.airb_level = 15 }
		}
		if = {
			limit = {
				air_base > 15
				air_base < 17
			}
			add_to_variable = { This.airb_level = 16 }
		}
		if = {
			limit = {
				air_base > 16
				air_base < 18
			}
			add_to_variable = { This.airb_level = 17 }
		}
		if = {
			limit = {
				air_base > 17
				air_base < 19
			}
			add_to_variable = { This.airb_level = 18 }
		}
		if = {
			limit = {
				air_base > 18
				air_base < 20
			}
			add_to_variable = { This.airb_level = 19 }
		}
		if = {
			limit = {
				air_base > 19
				air_base < 21
			}
			add_to_variable = { This.airb_level = 20 }
		}

		OWNER = {
			add_to_variable = { This.bst_country_average_airb = Prev.airb_level }
		}
	}
	every_country = {
		divide_variable = { This.bst_country_average_airb = This.bst_country_num_states }
	}	
}



bst_count_aa = {
	
	every_country = {
		set_variable = {
			This.bst_country_average_aa = 0
		}
		set_variable = {
			This.bst_country_num_states = This.num_owned_states
		}
	}	
	every_state = {
		set_variable = {
			This.aa_level = 0
		}
		if = {
			limit = {
				anti_air_building < 1
			}
			add_to_variable = { This.aa_level = 0 }
		}
		if = {
			limit = {
				anti_air_building > 0
				anti_air_building < 2
			}
			add_to_variable = { This.aa_level = 1 }
		}
		if = {
			limit = {
				anti_air_building > 1
				anti_air_building < 3
			}
			add_to_variable = { This.aa_level = 2 }
		}
		if = {
			limit = {
				anti_air_building > 2
				anti_air_building < 4
			}
			add_to_variable = { This.aa_level = 3 }
		}
		if = {
			limit = {
				anti_air_building > 3
				anti_air_building < 5
			}
			
			add_to_variable = { This.aa_level = 4 }
		}
		if = {
			limit = {
				anti_air_building > 4
				anti_air_building < 6
			}
			add_to_variable = { This.aa_level = 5 }
		}
		if = {
			limit = {
				anti_air_building > 5
				anti_air_building < 7
			}
			add_to_variable = { This.aa_level = 6 }
		}
		if = {
			limit = {
				anti_air_building > 6
				anti_air_building < 8
			}
			add_to_variable = { This.aa_level = 7 }
		}
		if = {
			limit = {
				anti_air_building > 7
				anti_air_building < 9
			}
			add_to_variable = { This.aa_level = 8 }
		} 
		if = {
			limit = {
				anti_air_building > 8
				anti_air_building < 10
			}
			add_to_variable = { This.aa_level = 9 }
		}
		if = {
			limit = {
				anti_air_building > 9
				anti_air_building < 11
			}
			add_to_variable = { This.aa_level = 10 }
		}
		if = {
			limit = {
				anti_air_building > 10
				anti_air_building < 12
			}
			add_to_variable = { This.aa_level = 11 }
		}
		if = {
			limit = {
				anti_air_building > 11
				anti_air_building < 13
			}
			add_to_variable = { This.aa_level = 12 }
		}
		if = {
			limit = {
				anti_air_building > 12
				anti_air_building < 14
			}
			add_to_variable = { This.aa_level = 13 }
		}
		if = {
			limit = {
				anti_air_building > 13
				anti_air_building < 15
			}
			add_to_variable = { This.aa_level = 14 }
		}
		if = {
			limit = {
				anti_air_building > 14
				anti_air_building < 16
			}
			add_to_variable = { This.aa_level = 15 }
		}
		if = {
			limit = {
				anti_air_building > 15
				anti_air_building < 17
			}
			add_to_variable = { This.aa_level = 16 }
		}
		if = {
			limit = {
				anti_air_building > 16
				anti_air_building < 18
			}
			add_to_variable = { This.aa_level = 17 }
		}
		if = {
			limit = {
				anti_air_building > 17
				anti_air_building < 19
			}
			add_to_variable = { This.aa_level = 18 }
		}
		if = {
			limit = {
				anti_air_building > 18
				anti_air_building < 20
			}
			add_to_variable = { This.aa_level = 19 }
		}
		if = {
			limit = {
				anti_air_building > 19
				anti_air_building < 21
			}
			add_to_variable = { This.aa_level = 20 }
		}

		OWNER = {
			add_to_variable = { This.bst_country_average_aa = Prev.aa_level }
		}
	}
	every_country = {
		divide_variable = { This.bst_country_average_aa = This.bst_country_num_states }
	}	
}

bst_count_radar = {
	
	every_country = {
		set_variable = {
			This.bst_country_average_radar = 0
		}
		set_variable = {
			This.bst_country_num_states = This.num_owned_states
		}
	}	
	every_state = {
		set_variable = {
			This.radar_level = 0
		}
		if = {
			limit = {
				radar_station < 1
			}
			add_to_variable = { This.radar_level = 0 }
		}
		if = {
			limit = {
				radar_station > 0
				radar_station < 2
			}
			add_to_variable = { This.radar_level = 1 }
		}
		if = {
			limit = {
				radar_station > 1
				radar_station < 3
			}
			add_to_variable = { This.radar_level = 2 }
		}
		if = {
			limit = {
				radar_station > 2
				radar_station < 4
			}
			add_to_variable = { This.radar_level = 3 }
		}
		if = {
			limit = {
				radar_station > 3
				radar_station < 5
			}
			
			add_to_variable = { This.radar_level = 4 }
		}
		if = {
			limit = {
				radar_station > 4
				radar_station < 6
			}
			add_to_variable = { This.radar_level = 5 }
		}
		if = {
			limit = {
				radar_station > 5
				radar_station < 7
			}
			add_to_variable = { This.radar_level = 6 }
		}
		if = {
			limit = {
				radar_station > 6
				radar_station < 8
			}
			add_to_variable = { This.radar_level = 7 }
		}
		if = {
			limit = {
				radar_station > 7
				radar_station < 9
			}
			add_to_variable = { This.radar_level = 8 }
		} 
		if = {
			limit = {
				radar_station > 8
				radar_station < 10
			}
			add_to_variable = { This.radar_level = 9 }
		}
		if = {
			limit = {
				radar_station > 9
				radar_station < 11
			}
			add_to_variable = { This.radar_level = 10 }
		}
		if = {
			limit = {
				radar_station > 10
				radar_station < 12
			}
			add_to_variable = { This.radar_level = 11 }
		}
		if = {
			limit = {
				radar_station > 11
				radar_station < 13
			}
			add_to_variable = { This.radar_level = 12 }
		}
		if = {
			limit = {
				radar_station > 12
				radar_station < 14
			}
			add_to_variable = { This.radar_level = 13 }
		}
		if = {
			limit = {
				radar_station > 13
				radar_station < 15
			}
			add_to_variable = { This.radar_level = 14 }
		}
		if = {
			limit = {
				radar_station > 14
				radar_station < 16
			}
			add_to_variable = { This.radar_level = 15 }
		}
		if = {
			limit = {
				radar_station > 15
				radar_station < 17
			}
			add_to_variable = { This.radar_level = 16 }
		}
		if = {
			limit = {
				radar_station > 16
				radar_station < 18
			}
			add_to_variable = { This.radar_level = 17 }
		}
		if = {
			limit = {
				radar_station > 17
				radar_station < 19
			}
			add_to_variable = { This.radar_level = 18 }
		}
		if = {
			limit = {
				radar_station > 18
				radar_station < 20
			}
			add_to_variable = { This.radar_level = 19 }
		}
		if = {
			limit = {
				radar_station > 19
				radar_station < 21
			}
			add_to_variable = { This.radar_level = 20 }
		}

		OWNER = {
			add_to_variable = { This.bst_country_average_radar = Prev.radar_level }
		}
	}
	every_country = {
		divide_variable = { This.bst_country_average_radar = This.bst_country_num_states }
	}	
}


bst_count_rocket = {
	
	every_country = {
		set_variable = {
			This.bst_country_average_rocket_site = 0
		}
		set_variable = {
			This.bst_country_num_states = This.num_owned_states
		}
	}	
	every_state = {
		set_variable = {
			This.rocket_site_level = 0
		}
		if = {
			limit = {
				rocket_site < 1
			}
			add_to_variable = { This.rocket_site_level = 0 }
		}
		if = {
			limit = {
				rocket_site > 0
				rocket_site < 2
			}
			add_to_variable = { This.rocket_site_level = 1 }
		}
		if = {
			limit = {
				rocket_site > 1
				rocket_site < 3
			}
			add_to_variable = { This.rocket_site_level = 2 }
		}
		if = {
			limit = {
				rocket_site > 2
				rocket_site < 4
			}
			add_to_variable = { This.rocket_site_level = 3 }
		}
		if = {
			limit = {
				rocket_site > 3
				rocket_site < 5
			}
			
			add_to_variable = { This.rocket_site_level = 4 }
		}
		if = {
			limit = {
				rocket_site > 4
				rocket_site < 6
			}
			add_to_variable = { This.rocket_site_level = 5 }
		}
		if = {
			limit = {
				rocket_site > 5
				rocket_site < 7
			}
			add_to_variable = { This.rocket_site_level = 6 }
		}
		if = {
			limit = {
				rocket_site > 6
				rocket_site < 8
			}
			add_to_variable = { This.rocket_site_level = 7 }
		}
		if = {
			limit = {
				rocket_site > 7
				rocket_site < 9
			}
			add_to_variable = { This.rocket_site_level = 8 }
		} 
		if = {
			limit = {
				rocket_site > 8
				rocket_site < 10
			}
			add_to_variable = { This.rocket_site_level = 9 }
		}
		if = {
			limit = {
				rocket_site > 9
				rocket_site < 11
			}
			add_to_variable = { This.rocket_site_level = 10 }
		}
		if = {
			limit = {
				rocket_site > 10
				rocket_site < 12
			}
			add_to_variable = { This.rocket_site_level = 11 }
		}
		if = {
			limit = {
				rocket_site > 11
				rocket_site < 13
			}
			add_to_variable = { This.rocket_site_level = 12 }
		}
		if = {
			limit = {
				rocket_site > 12
				rocket_site < 14
			}
			add_to_variable = { This.rocket_site_level = 13 }
		}
		if = {
			limit = {
				rocket_site > 13
				rocket_site < 15
			}
			add_to_variable = { This.rocket_site_level = 14 }
		}
		if = {
			limit = {
				rocket_site > 14
				rocket_site < 16
			}
			add_to_variable = { This.rocket_site_level = 15 }
		}
		if = {
			limit = {
				rocket_site > 15
				rocket_site < 17
			}
			add_to_variable = { This.rocket_site_level = 16 }
		}
		if = {
			limit = {
				rocket_site > 16
				rocket_site < 18
			}
			add_to_variable = { This.rocket_site_level = 17 }
		}
		if = {
			limit = {
				rocket_site > 17
				rocket_site < 19
			}
			add_to_variable = { This.rocket_site_level = 18 }
		}
		if = {
			limit = {
				rocket_site > 18
				rocket_site < 20
			}
			add_to_variable = { This.rocket_site_level = 19 }
		}
		if = {
			limit = {
				rocket_site > 19
				rocket_site < 21
			}
			add_to_variable = { This.rocket_site_level = 20 }
		}

		OWNER = {
			add_to_variable = { This.bst_country_average_rocket_site = Prev.rocket_site_level }
		}
	}
}


bst_count_nuclear = {
	
	every_country = {
		set_variable = {
			This.bst_country_average_nuclear_reactor = 0
		}
		set_variable = {
			This.bst_country_num_states = This.num_owned_states
		}
	}	
	every_state = {
		set_variable = {
			This.nuclear_reactor_level = 0
		}
		if = {
			limit = {
				nuclear_reactor < 1
			}
			add_to_variable = { This.nuclear_reactor_level = 0 }
		}
		if = {
			limit = {
				nuclear_reactor > 0
				nuclear_reactor < 2
			}
			add_to_variable = { This.nuclear_reactor_level = 1 }
		}
		if = {
			limit = {
				nuclear_reactor > 1
				nuclear_reactor < 3
			}
			add_to_variable = { This.nuclear_reactor_level = 2 }
		}
		if = {
			limit = {
				nuclear_reactor > 2
				nuclear_reactor < 4
			}
			add_to_variable = { This.nuclear_reactor_level = 3 }
		}
		if = {
			limit = {
				nuclear_reactor > 3
				nuclear_reactor < 5
			}
			
			add_to_variable = { This.nuclear_reactor_level = 4 }
		}
		if = {
			limit = {
				nuclear_reactor > 4
				nuclear_reactor < 6
			}
			add_to_variable = { This.nuclear_reactor_level = 5 }
		}
		if = {
			limit = {
				nuclear_reactor > 5
				nuclear_reactor < 7
			}
			add_to_variable = { This.nuclear_reactor_level = 6 }
		}
		if = {
			limit = {
				nuclear_reactor > 6
				nuclear_reactor < 8
			}
			add_to_variable = { This.nuclear_reactor_level = 7 }
		}
		if = {
			limit = {
				nuclear_reactor > 7
				nuclear_reactor < 9
			}
			add_to_variable = { This.nuclear_reactor_level = 8 }
		} 
		if = {
			limit = {
				nuclear_reactor > 8
				nuclear_reactor < 10
			}
			add_to_variable = { This.nuclear_reactor_level = 9 }
		}
		if = {
			limit = {
				nuclear_reactor > 9
				nuclear_reactor < 11
			}
			add_to_variable = { This.nuclear_reactor_level = 10 }
		}
		if = {
			limit = {
				nuclear_reactor > 10
				nuclear_reactor < 12
			}
			add_to_variable = { This.nuclear_reactor_level = 11 }
		}
		if = {
			limit = {
				nuclear_reactor > 11
				nuclear_reactor < 13
			}
			add_to_variable = { This.nuclear_reactor_level = 12 }
		}
		if = {
			limit = {
				nuclear_reactor > 12
				nuclear_reactor < 14
			}
			add_to_variable = { This.nuclear_reactor_level = 13 }
		}
		if = {
			limit = {
				nuclear_reactor > 13
				nuclear_reactor < 15
			}
			add_to_variable = { This.nuclear_reactor_level = 14 }
		}
		if = {
			limit = {
				nuclear_reactor > 14
				nuclear_reactor < 16
			}
			add_to_variable = { This.nuclear_reactor_level = 15 }
		}
		if = {
			limit = {
				nuclear_reactor > 15
				nuclear_reactor < 17
			}
			add_to_variable = { This.nuclear_reactor_level = 16 }
		}
		if = {
			limit = {
				nuclear_reactor > 16
				nuclear_reactor < 18
			}
			add_to_variable = { This.nuclear_reactor_level = 17 }
		}
		if = {
			limit = {
				nuclear_reactor > 17
				nuclear_reactor < 19
			}
			add_to_variable = { This.nuclear_reactor_level = 18 }
		}
		if = {
			limit = {
				nuclear_reactor > 18
				nuclear_reactor < 20
			}
			add_to_variable = { This.nuclear_reactor_level = 19 }
		}
		if = {
			limit = {
				nuclear_reactor > 19
				nuclear_reactor < 21
			}
			add_to_variable = { This.nuclear_reactor_level = 20 }
		}

		OWNER = {
			add_to_variable = { This.bst_country_average_nuclear_reactor = Prev.nuclear_reactor_level }
		}
	}
}
bst_count_synthetic = {
	
	every_country = {
		set_variable = {
			This.bst_country_average_synthetic_refinery = 0
		}
		set_variable = {
			This.bst_country_num_states = This.num_owned_states
		}
	}	
	every_state = {
		set_variable = {
			This.synthetic_refinery_level = 0
		}
		if = {
			limit = {
				synthetic_refinery < 1
			}
			add_to_variable = { This.synthetic_refinery_level = 0 }
		}
		if = {
			limit = {
				synthetic_refinery > 0
				synthetic_refinery < 2
			}
			add_to_variable = { This.synthetic_refinery_level = 1 }
		}
		if = {
			limit = {
				synthetic_refinery > 1
				synthetic_refinery < 3
			}
			add_to_variable = { This.synthetic_refinery_level = 2 }
		}
		if = {
			limit = {
				synthetic_refinery > 2
				synthetic_refinery < 4
			}
			add_to_variable = { This.synthetic_refinery_level = 3 }
		}
		if = {
			limit = {
				synthetic_refinery > 3
				synthetic_refinery < 5
			}
			
			add_to_variable = { This.synthetic_refinery_level = 4 }
		}
		if = {
			limit = {
				synthetic_refinery > 4
				synthetic_refinery < 6
			}
			add_to_variable = { This.synthetic_refinery_level = 5 }
		}
		if = {
			limit = {
				synthetic_refinery > 5
				synthetic_refinery < 7
			}
			add_to_variable = { This.synthetic_refinery_level = 6 }
		}
		if = {
			limit = {
				synthetic_refinery > 6
				synthetic_refinery < 8
			}
			add_to_variable = { This.synthetic_refinery_level = 7 }
		}
		if = {
			limit = {
				synthetic_refinery > 7
				synthetic_refinery < 9
			}
			add_to_variable = { This.synthetic_refinery_level = 8 }
		} 
		if = {
			limit = {
				synthetic_refinery > 8
				synthetic_refinery < 10
			}
			add_to_variable = { This.synthetic_refinery_level = 9 }
		}
		if = {
			limit = {
				synthetic_refinery > 9
				synthetic_refinery < 11
			}
			add_to_variable = { This.synthetic_refinery_level = 10 }
		}
		if = {
			limit = {
				synthetic_refinery > 10
				synthetic_refinery < 12
			}
			add_to_variable = { This.synthetic_refinery_level = 11 }
		}
		if = {
			limit = {
				synthetic_refinery > 11
				synthetic_refinery < 13
			}
			add_to_variable = { This.synthetic_refinery_level = 12 }
		}
		if = {
			limit = {
				synthetic_refinery > 12
				synthetic_refinery < 14
			}
			add_to_variable = { This.synthetic_refinery_level = 13 }
		}
		if = {
			limit = {
				synthetic_refinery > 13
				synthetic_refinery < 15
			}
			add_to_variable = { This.synthetic_refinery_level = 14 }
		}
		if = {
			limit = {
				synthetic_refinery > 14
				synthetic_refinery < 16
			}
			add_to_variable = { This.synthetic_refinery_level = 15 }
		}
		if = {
			limit = {
				synthetic_refinery > 15
				synthetic_refinery < 17
			}
			add_to_variable = { This.synthetic_refinery_level = 16 }
		}
		if = {
			limit = {
				synthetic_refinery > 16
				synthetic_refinery < 18
			}
			add_to_variable = { This.synthetic_refinery_level = 17 }
		}
		if = {
			limit = {
				synthetic_refinery > 17
				synthetic_refinery < 19
			}
			add_to_variable = { This.synthetic_refinery_level = 18 }
		}
		if = {
			limit = {
				synthetic_refinery > 18
				synthetic_refinery < 20
			}
			add_to_variable = { This.synthetic_refinery_level = 19 }
		}
		if = {
			limit = {
				synthetic_refinery > 19
				synthetic_refinery < 21
			}
			add_to_variable = { This.synthetic_refinery_level = 20 }
		}

		OWNER = {
			add_to_variable = { This.bst_country_average_synthetic_refinery = Prev.synthetic_refinery_level }
		}
	}
}

bst_count_silo = {
	
	every_country = {
		set_variable = {
			This.bst_country_average_fuel_silo = 0
		}
		set_variable = {
			This.bst_country_num_states = This.num_owned_states
		}
	}	
	every_state = {
		set_variable = {
			This.fuel_silo_level = 0
		}
		if = {
			limit = {
				fuel_silo < 1
			}
			add_to_variable = { This.fuel_silo_level = 0 }
		}
		if = {
			limit = {
				fuel_silo > 0
				fuel_silo < 2
			}
			add_to_variable = { This.fuel_silo_level = 1 }
		}
		if = {
			limit = {
				fuel_silo > 1
				fuel_silo < 3
			}
			add_to_variable = { This.fuel_silo_level = 2 }
		}
		if = {
			limit = {
				fuel_silo > 2
				fuel_silo < 4
			}
			add_to_variable = { This.fuel_silo_level = 3 }
		}
		if = {
			limit = {
				fuel_silo > 3
				fuel_silo < 5
			}
			
			add_to_variable = { This.fuel_silo_level = 4 }
		}
		if = {
			limit = {
				fuel_silo > 4
				fuel_silo < 6
			}
			add_to_variable = { This.fuel_silo_level = 5 }
		}
		if = {
			limit = {
				fuel_silo > 5
				fuel_silo < 7
			}
			add_to_variable = { This.fuel_silo_level = 6 }
		}
		if = {
			limit = {
				fuel_silo > 6
				fuel_silo < 8
			}
			add_to_variable = { This.fuel_silo_level = 7 }
		}
		if = {
			limit = {
				fuel_silo > 7
				fuel_silo < 9
			}
			add_to_variable = { This.fuel_silo_level = 8 }
		} 
		if = {
			limit = {
				fuel_silo > 8
				fuel_silo < 10
			}
			add_to_variable = { This.fuel_silo_level = 9 }
		}
		if = {
			limit = {
				fuel_silo > 9
				fuel_silo < 11
			}
			add_to_variable = { This.fuel_silo_level = 10 }
		}
		if = {
			limit = {
				fuel_silo > 10
				fuel_silo < 12
			}
			add_to_variable = { This.fuel_silo_level = 11 }
		}
		if = {
			limit = {
				fuel_silo > 11
				fuel_silo < 13
			}
			add_to_variable = { This.fuel_silo_level = 12 }
		}
		if = {
			limit = {
				fuel_silo > 12
				fuel_silo < 14
			}
			add_to_variable = { This.fuel_silo_level = 13 }
		}
		if = {
			limit = {
				fuel_silo > 13
				fuel_silo < 15
			}
			add_to_variable = { This.fuel_silo_level = 14 }
		}
		if = {
			limit = {
				fuel_silo > 14
				fuel_silo < 16
			}
			add_to_variable = { This.fuel_silo_level = 15 }
		}
		if = {
			limit = {
				fuel_silo > 15
				fuel_silo < 17
			}
			add_to_variable = { This.fuel_silo_level = 16 }
		}
		if = {
			limit = {
				fuel_silo > 16
				fuel_silo < 18
			}
			add_to_variable = { This.fuel_silo_level = 17 }
		}
		if = {
			limit = {
				fuel_silo > 17
				fuel_silo < 19
			}
			add_to_variable = { This.fuel_silo_level = 18 }
		}
		if = {
			limit = {
				fuel_silo > 18
				fuel_silo < 20
			}
			add_to_variable = { This.fuel_silo_level = 19 }
		}
		if = {
			limit = {
				fuel_silo > 19
				fuel_silo < 21
			}
			add_to_variable = { This.fuel_silo_level = 20 }
		}

		OWNER = {
			add_to_variable = { This.bst_country_average_fuel_silo = Prev.fuel_silo_level }
		}
	}
}


bst_count_armsf = {
	
	every_country = {
		set_variable = {
			This.bst_country_armsf = 0
		}
	}	
	every_state = {
		set_variable = {
			bst_state_armsf = 0
		}
		add_to_variable = { bst_state_armsf = This.arms_factory_level }
		OWNER = {
			add_to_variable = { This.bst_country_armsf = Prev.bst_state_armsf }
		}
	}
}

bst_count_civf = {
	
	every_country = {
		set_variable = {
			This.bst_country_civf = 0
		}
	}
	every_state = {
		set_variable = {
			bst_state_civf = 0
		}
		add_to_variable = { bst_state_civf = This.industrial_complex_level }
		OWNER = {
			add_to_variable = { This.bst_country_civf = Prev.bst_state_civf }
		}
	}

	# The best code ever - RIP
	#every_country = {
	#	set_variable = { ger.bst_civf_country = this.num_of_civilian_factories }
	#	every_owned_state = {
	#		set_variable = { this.bst_civf_amount = ger.bst_civf_country }
	#	}
	#	####################
	#	set_variable = { ger.bst_civf_country = this.num_of_civilian_factories }
	#	every_owned_state = {
	#		set_variable = {
	#			this.bst_civf_country = this.industrial_complex
	#		}
	#	}
	#}
}


tcw_clear_all_global_confirms = {
	clr_global_flag = tpt_confirm_faction_dismantling
	clr_global_flag = dst_a_confirm_unit_deletion
	clr_global_flag = dst_b_confirm_unit_deletion
	clr_global_flag = sst_confirm_ship_deletion
}


bst_count_navf = {
	every_country = {
		set_variable = {
			This.bst_country_navf = 0
		}
	}
	every_state = {
		set_variable = {
			bst_state_navf = 0
		}
		if = {
			limit = {
				dockyard > 0
				dockyard < 2
			}
			add_to_variable = { bst_state_navf = 1 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 1
				dockyard < 3
			}
			add_to_variable = { bst_state_navf = 2 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 2
				dockyard < 4
			}
			add_to_variable = { bst_state_navf = 3 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 3
				dockyard < 5
			}
			add_to_variable = { bst_state_navf = 4 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 4
				dockyard < 6
			}
			add_to_variable = { bst_state_navf = 5 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 5
				dockyard < 7
			}
			add_to_variable = { bst_state_navf = 6 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 6
				dockyard < 8
			}
			add_to_variable = { bst_state_navf = 7 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 7
				dockyard < 9
			}
			add_to_variable = { bst_state_navf = 8 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 8
				dockyard < 10
			}
			add_to_variable = { bst_state_navf = 9 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 9
				dockyard < 11
			}
			add_to_variable = { bst_state_navf = 10 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 10
				dockyard < 12
			}
			add_to_variable = { bst_state_navf = 11 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 11
				dockyard < 13
			}
			add_to_variable = { bst_state_navf = 12 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 12
				dockyard < 14
			}
			add_to_variable = { bst_state_navf = 13 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 13
				dockyard < 15
			}
			add_to_variable = { bst_state_navf = 14 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 14
				dockyard < 16
			}
			add_to_variable = { bst_state_navf = 15 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 15
				dockyard < 17
			}
			add_to_variable = { bst_state_navf = 16 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 16
				dockyard < 18
			}
			add_to_variable = { bst_state_navf = 17 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 17
				dockyard < 19
			}
			add_to_variable = { bst_state_navf = 18 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 18
				dockyard < 20
			}
			add_to_variable = { bst_state_navf = 19 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
		if = {
			limit = {
				dockyard > 19
			}
			add_to_variable = { bst_state_navf = 20 }
			OWNER = {
				add_to_variable = { This.bst_country_navf = Prev.bst_state_navf }
			}
		}
	}
}
tpt_remove_template_lock = {
	if = {
		limit = {
			has_template = "Makedonska Revolyutsionna Militsiya"
		}
		set_division_template_lock = {
			division_template = "Makedonska Revolyutsionna Militsiya"
			is_locked = no
		}
	}
	#France
	if = {
		limit = {
			has_template = "Syria Intervention Force" 	
		}
		set_division_template_lock = {
			division_template = "Syria Intervention Force" 	
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Syria Defense Force" 	
		}
		set_division_template_lock = {
			division_template = "Syria Defense Force" 	
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Indochina Intervention Force" 
		}
		set_division_template_lock = {
			division_template = "Indochina Intervention Force" 
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Indochina Defense Force"
		}
		set_division_template_lock = {
			division_template = "Indochina Defense Force"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Central Africa Intervention Force"
		}
		set_division_template_lock = {
			division_template = "Central Africa Intervention Force"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Central Africa Defense Force"
		}
		set_division_template_lock = {
			division_template = "Central Africa Defense Force"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "West Africa Intervention Force"
		}
		set_division_template_lock = {
			division_template = "West Africa Intervention Force"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "West Africa Defense Force"
		}
		set_division_template_lock = {
			division_template = "West Africa Defense Force"
			is_locked = no
		}
	}
	#Italy
	if = {
		limit = {
			has_template = "Divisione Partigiana"
		}
		set_division_template_lock = {
			division_template = "Divisione Partigiana"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Truppe Irregolari a Cavallo"
		}
		set_division_template_lock = {
			division_template = "Truppe Irregolari a Cavallo"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Truppe Irregolari di Cammelli"
		}
		set_division_template_lock = {
			division_template = "Truppe Irregolari di Cammelli"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Cavalleria Coloniale"
		}
		set_division_template_lock = {
			division_template = "Cavalleria Coloniale"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Banda Indigena Irregolare"
		}
		set_division_template_lock = {
			division_template = "Banda Indigena Irregolare"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Camicie Nere" 
		}
		set_division_template_lock = {
			division_template = "Camicie Nere"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Camicie Rosse" 
		}
		set_division_template_lock = {
			division_template = "Camicie Rosse"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Banda Irregolare Eritrea"
		}
		set_division_template_lock = {
			division_template = "Banda Irregolare Eritrea"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Banda Irregolare Somala"
		}
		set_division_template_lock = {
			division_template = "Banda Irregolare Somala"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Banda Irregolare Libica"
		}
		set_division_template_lock = {
			division_template = "Banda Irregolare Libica"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Banda Indigena Irregolare"
		}
		set_division_template_lock = {
			division_template = "Banda Indigena Irregolare"
			is_locked = no
		}
	}
	#???
	if = {
		limit = {
			has_template = "Tomislav's Royal Guards"
		}
		set_division_template_lock = {
			division_template = "Tomislav's Royal Guards"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Montenegrin Chetniks"
		}
		set_division_template_lock = {
			division_template = "Montenegrin Chetniks"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Redemption Army"
		}
		set_division_template_lock = {
			division_template = "Redemption Army"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Manchu Banner"
		}
		set_division_template_lock = {
			division_template = "Manchu Banner"
			is_locked = no
		}
	}
	#Soviets
	if = {
		limit = {
			has_template = "Shtrafnaya Chast"
		}
		set_division_template_lock = {
			division_template = "Shtrafnaya Chast"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Trotskyist Revolutionary Militias"
		}
		set_division_template_lock = {
			division_template = "Trotskyist Revolutionary Militias"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Resistance Fighters"	#Also used by Ethiopia
		}
		set_division_template_lock = {
			division_template = "Resistance Fighters"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Peasant Militia"
		}
		set_division_template_lock = {
			division_template = "Peasant Militia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "International Marxist Brigades"
		}
		set_division_template_lock = {
			division_template = "International Marxist Brigades"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Soviet Special Brigades"
		}
		set_division_template_lock = {
			division_template = "Soviet Special Brigades"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "POUM Special Brigades"
		}
		set_division_template_lock = {
			division_template = "POUM Special Brigades"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Brigada de las Juventudes del POUM"
		}
		set_division_template_lock = {
			division_template = "Brigada de las Juventudes del POUM"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Trotskyist Workers' Militia"
		}
		set_division_template_lock = {
			division_template = "Trotskyist Workers' Militia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Trotskyist Peasant Militia"
		}
		set_division_template_lock = {
			division_template = "Trotskyist Peasant Militia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Bukharinist Workers' Militia"
		}
		set_division_template_lock = {
			division_template = "Bukharinist Workers' Militia"
			is_locked = no
		}
	}		
	if = {
		limit = {
			has_template = "Bukharinist Peasant Militia"
		}
		set_division_template_lock = {
			division_template = "Bukharinist Peasant Militia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Japanese Expeditionary Force"
		}
		set_division_template_lock = {
			division_template = "Japanese Expeditionary Force"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Opposition Partisan Brigade"
		}
		set_division_template_lock = {
			division_template = "Opposition Partisan Brigade"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "International Brigades"
		}
		set_division_template_lock = {
			division_template = "International Brigades"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "German Trained Division"
		}
		set_division_template_lock = {
			division_template = "German Trained Division"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "NKVD Pogranichnaya Diviziya"
		}
		set_division_template_lock = {
			division_template = "NKVD Pogranichnaya Diviziya"
			is_locked = no
		}
	}
	#Spain
	if = {
		limit = {
			has_template = "Brigada Internacionales"
		}
		set_division_template_lock = {
			division_template = "Brigada Internacionales"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Fifth Columnist Brigade"
		}
		set_division_template_lock = {
			division_template = "Fifth Columnist Brigade"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Anarchist Militia"
		}
		set_division_template_lock = {
			division_template = "Anarchist Militia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Carabineros"
		}
		set_division_template_lock = {
			division_template = "Carabineros"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Brigada Legionario"
		}
		set_division_template_lock = {
			division_template = "Brigada Legionario"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Guarnición Nacionalista"
		}
		set_division_template_lock = {
			division_template = "Guarnición Nacionalista"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Guarnición Republicana"
		}
		set_division_template_lock = {
			division_template = "Guarnición Republicana"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Requeté Carlista"
		}
		set_division_template_lock = {
			division_template = "Requeté Carlista"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "División de la Guardia de Asalto"
		}
		set_division_template_lock = {
			division_template = "División de la Guardia de Asalto"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Brigada de la Guardia Civil"
		}
		set_division_template_lock = {
			division_template = "Brigada de la Guardia Civil"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Brigada de la Guardia Civil"
		}
		set_division_template_lock = {
			division_template = "Brigada de la Guardia Civil"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Brigada de Juventudes Sindicales"
		}
		set_division_template_lock = {
			division_template = "Brigada de Juventudes Sindicales"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Brigada Popular"
		}
		set_division_template_lock = {
			division_template = "Brigada Popular"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Brigada Anarquista"
		}
		set_division_template_lock = {
			division_template = "Brigada Anarquista"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Spanish Loyalist Division"
		}
		set_division_template_lock = {
			division_template = "Spanish Loyalist Division"
			is_locked = no
		}
	}
	#Britain
	if = {
		limit = {
			has_template = "Loyalist Brigade"
		}
		set_division_template_lock = {
			division_template = "Loyalist Brigade"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Blackshirt Brigade"
		}
		set_division_template_lock = {
			division_template = "Blackshirt Brigade"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Pakistani Liberation Army"
		}
		set_division_template_lock = {
			division_template = "Pakistani Liberation Army"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Hindu Militia"
		}
		set_division_template_lock = {
			division_template = "Hindu Militia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Bangladeshi Liberation Army"
		}
		set_division_template_lock = {
			division_template = "Bangladeshi Liberation Army"
			is_locked = no
		}
	}
	#USA
	if = {
		limit = {
			has_template = "Local Volunteers"
		}
		set_division_template_lock = {
			division_template = "Local Volunteers"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Citizen Militia"
		}
		set_division_template_lock = {
			division_template = "Citizen Militia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Silver Legion"
		}
		set_division_template_lock = {
			division_template = "Silver Legion"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Exiles"
		}
		set_division_template_lock = {
			division_template = "Exiles"
			is_locked = no
		}
	}
	#Baltics
	if = {
		limit = {
			has_template = "Soviet Volunteers" #Also used by Japan
		}
		set_division_template_lock = {
			division_template = "Soviet Volunteers"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Forest Brothers"
		}
		set_division_template_lock = {
			division_template = "Forest Brothers"
			is_locked = no
		}
	}	
	#Germany (SS)
	if = {
		limit = {
			has_template = "SS Motorisierte Division"
		}
		set_division_template_lock = {
			division_template = "SS Motorisierte Division"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "SS Panzergrenadier Division"
		}
		set_division_template_lock = {
			division_template = "SS Panzergrenadier Division"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "SS Panzergrenadier Division (n.A.)"
		}
		set_division_template_lock = {
			division_template = "SS Panzergrenadier Division (n.A.)"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "SS Panzer Division"
		}
		set_division_template_lock = {
			division_template = "SS Panzer Division"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "SS Panzer Division (n.A.)"
		}
		set_division_template_lock = {
			division_template = "SS Panzer Division (n.A.)"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "SS Panzer Division (vollgep.)"
		}
		set_division_template_lock = {
			division_template = "SS Panzer Division (vollgep.)"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "SS Waffen-Grenadier-Division"
		}
		set_division_template_lock = {
			division_template = "SS Waffen-Grenadier-Division"
			is_locked = no
		}
	}
	#Germany (civil war)
	if = {
		limit = {
			has_template = "SS-Sturmbrigade"
		}
		set_division_template_lock = {
			division_template = "SS-Sturmbrigade"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Landsturmregiment"
		}
		set_division_template_lock = {
			division_template = "Landsturmregiment"
			is_locked = no
		}
	}
	#Ethiopia
	if = {
		limit = {
			has_template = "Arbegnoch Fighters"
		}
		set_division_template_lock = {
			division_template = "Arbegnoch Fighters"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Kebur Zabagna"
		}
		set_division_template_lock = {
			division_template = "Kebur Zabagna"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Chitet Sefari"
		}
		set_division_template_lock = {
			division_template = "Chitet Sefari"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Guards"
		}
		set_division_template_lock = {
			division_template = "Guards"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Red Guards"
		}
		set_division_template_lock = {
			division_template = "Red Guards"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Black Lions"
		}
		set_division_template_lock = {
			division_template = "Black Lions"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Eritrean Askari"
		}
		set_division_template_lock = {
			division_template = "Eritrean Askari"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "International brigade"
		}
		set_division_template_lock = {
			division_template = "International brigade"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Irregular Cavalry Division"
		}
		set_division_template_lock = {
			division_template = "Irregular Cavalry Division"
			is_locked = no
		}
	}
	if = {	#might be a typo here
		limit = {
			has_template = "Irregular Camalry Division"
		}
		set_division_template_lock = {
			division_template = "Irregular Camalry Division"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Congolese Mercenaries"
		}
		set_division_template_lock = {
			division_template = "Congolese Mercenaries"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Arab Mercenaries"
		}
		set_division_template_lock = {
			division_template = "Arab Mercenaries"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Sudanese Mercenaries"
		}
		set_division_template_lock = {
			division_template = "Sudanese Mercenaries"
			is_locked = no
		}
	}
	#Rebellions
	if = {
		limit = {
			has_template = "Resistance"
		}
		set_division_template_lock = {
			division_template = "Resistance"
			is_locked = no
		}
	}
	#India
	if = {
		limit = {
			has_template = "Battaglione Azad Hindoustan"
		}
		set_division_template_lock = {
			division_template = "Battaglione Azad Hindoustan"
			is_locked = no
		}
	}
	#Bulgaria
	if = {
		limit = {
			has_template = "Fatherland Front Militia"
		}
		set_division_template_lock = {
			division_template = "Fatherland Front Militia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Fatherland Front Partisans"
		}
		set_division_template_lock = {
			division_template = "Fatherland Front Partisans"
			is_locked = no
		}
	}
	#Yugoslavia
	if = {
		limit = {
			has_template = "Yugoslavian Defence Army"
		}
		set_division_template_lock = {
			division_template = "Yugoslavian Defence Army"
			is_locked = no
		}
	}
	#Switzerland
	if = {
		limit = {
			has_template = "Leichte-Brigade"
		}
		set_division_template_lock = {
			division_template = "Leichte-Brigade"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Swiss Citizen Militia"
		}
		set_division_template_lock = {
			division_template = "Swiss Citizen Militia"
			is_locked = no
		}
	}
	#Mixed
	if = {
		limit = {
			has_template ="FFI Demi-Brigade" #Free France
		}
		set_division_template_lock = {
			division_template ="FFI Demi-Brigade"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "East African Irregulars" #Horn of Africa
		}
		set_division_template_lock = {
			division_template = "East African Irregulars"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Maori Volunteers" #New Zealand
		}
		set_division_template_lock = {
			division_template = "Maori Volunteers"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Morges Division" #Poland
		}
		set_division_template_lock = {
			division_template = "Morges Division"
			is_locked = no
		}
	}
	#Japan (civil war)
	if = {
		limit = {
			has_template = "Japanese People's Regiment"
		}
		set_division_template_lock = {
			division_template = "Japanese People's Regiment"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Japanese Loyalist Regiment"
		}
		set_division_template_lock = {
			division_template = "Japanese Loyalist Regiment"
			is_locked = no
		}
	}
	#Latvia
	if = {
		limit = {
			has_template = "Ugonskrust Division"
		}
		set_division_template_lock = {
			division_template = "Ugonskrust Division"
			is_locked = no
		}
	}
	#Netherlands
	if = {
		limit = {
			has_template = "Hare Majesteits Duitse Legioen"
		}
		set_division_template_lock = {
			division_template = "Hare Majesteits Duitse Legioen"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "American Garrison"
		}
		set_division_template_lock = {
			division_template = "American Garrison"
			is_locked = no
		}
	}
	#Denmark
	if = {
		limit = {
			has_template = "Landstormen Militia"
		}
		set_division_template_lock = {
			division_template = "Landstormen Militia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Modstandsbevægelsen Militia"
		}
		set_division_template_lock = {
			division_template = "Modstandsbevægelsen Militia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Danske Brigade"
		}
		set_division_template_lock = {
			division_template = "Danske Brigade"
			is_locked = no
		}
	}
	#Finland
	if = {
		limit = {
			has_template = "Rannikkorykmentti"
		}
		set_division_template_lock = {
			division_template = "Rannikkorykmentti"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Mustapaidat"
		}
		set_division_template_lock = {
			division_template = "Mustapaidat"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Punakaarti"
		}
		set_division_template_lock = {
			division_template = "Punakaarti"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Neuvostoliiton Legioona"
		}
		set_division_template_lock = {
			division_template = "Neuvostoliiton Legioona"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Rangaistusdivisioona"
		}
		set_division_template_lock = {
			division_template = "Rangaistusdivisioona"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Karjalan Metsäsissit"
		}
		set_division_template_lock = {
			division_template = "Karjalan Metsäsissit"
			is_locked = no
		}
	}
	#Sweden
	if = {
		limit = {
			has_template = "Mobile Headquarter"
		}
		set_division_template_lock = {
			division_template = "Mobile Headquarter"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Hemvärn"
		}
		set_division_template_lock = {
			division_template = "Hemvärn"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Stormtrupper"
		}
		set_division_template_lock = {
			division_template = "Stormtrupper"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Workers Militia"
		}
		set_division_template_lock = {
			division_template = "Workers Militia"
			is_locked = no
		}
	}
	#Norway
	if = {
		limit = {
			has_template = "Kongens Menn"
		}
		set_division_template_lock = {
			division_template = "Kongens Menn"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "forsvarsmilitser"
		}
		set_division_template_lock = {
			division_template = "forsvarsmilitser"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Hemmelige Hæren"
		}
		set_division_template_lock = {
			division_template = "Hemmelige Hæren"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Hirden Milits"
		}
		set_division_template_lock = {
			division_template = "Hirden Milits"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "våpenfolket"
		}
		set_division_template_lock = {
			division_template = "våpenfolket"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "folkets hær"
		}
		set_division_template_lock = {
			division_template = "folkets hær"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Norsk Milits"
		}
		set_division_template_lock = {
			division_template = "Norsk Milits"
			is_locked = no
		}
	}
	#Brazil
	if = {
		limit = {
			has_template = "Legião Estrangeira"
		}
		set_division_template_lock = {
			division_template = "Legião Estrangeira"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Batalhões de Presos"
		}
		set_division_template_lock = {
			division_template = "Batalhões de Presos"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Integralist Militia"
		}
		set_division_template_lock = {
			division_template = "Integralist Militia"
			is_locked = no
		}
	}
	#Chile
	if = {
		limit = {
			has_template = "Carabineros Patrios de Chile"
		}
		set_division_template_lock = {
			division_template = "Carabineros Patrios de Chile"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Voluntarios Argentinos"
		}
		set_division_template_lock = {
			division_template = "Voluntarios Argentinos"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Republican Guard"
		}
		set_division_template_lock = {
			division_template = "Republican Guard"
			is_locked = no
		}
	}
	#Hungary
	if = {
		limit = {
			has_template = "Rongyos Gárda"
		}
		set_division_template_lock = {
			division_template = "Rongyos Gárda"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Volksbundmiliz"
		}
		set_division_template_lock = {
			division_template = "Volksbundmiliz"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Volksbund Militia"
		}
		set_division_template_lock = {
			division_template = "Volksbund Militia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Horthysta Gyalogdándar"
		}
		set_division_template_lock = {
			division_template = "Horthysta Gyalogdándar"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Fasiszta Milícia"
		}
		set_division_template_lock = {
			division_template = "Fasiszta Milícia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Monarchista Milícia"
		}
		set_division_template_lock = {
			division_template = "Monarchista Milícia"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Lenin-fiúk"
		}
		set_division_template_lock = {
			division_template = "Lenin-fiúk"
			is_locked = no
		}
	}
	#Congo
	if = {
		limit = {
			has_template = "Division loyale de Léopoldville"
		}
		set_division_template_lock = {
			division_template = "Division loyale de Léopoldville"
			is_locked = no
		}
	}
	#Germany (misc)
	if = {
		limit = {
			has_template = "Straf-Division"
		}
		set_division_template_lock = {
			division_template = "Straf-Division"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Waffen-SS Division"
		}
		set_division_template_lock = {
			division_template = "Waffen-SS Division"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "SS-Verfügungstruppe"
		}
		set_division_template_lock = {
			division_template = "SS-Verfügungstruppe"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Afrikanische Schutztruppe"
		}
		set_division_template_lock = {
			division_template = "Afrikanische Schutztruppe"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Askari Schutztruppe"
		}
		set_division_template_lock = {
			division_template = "Askari Schutztruppe"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Asiatische Schutztruppe"
		}
		set_division_template_lock = {
			division_template = "Asiatische Schutztruppe"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Freikorps"
		}
		set_division_template_lock = {
			division_template = "Freikorps"
			is_locked = no
		}
	}
	if = {
		limit = {
			has_template = "Bund Wiking"
		}
		set_division_template_lock = {
			division_template = "Bund Wiking"
			is_locked = no
		}
	}
}
